---
description: "清理 CLAUDE.md 中不必要的元資訊"
usage: "/claude:clean [目錄路徑] [選項]"
argument-hint: "預設檢查當前目錄，可指定目錄或檔案"
allowed-tools: ["Read", "Write", "Edit", "Glob", "Grep", "Bash"]
permission-mode: "acceptEdits"
---

# CLAUDE.md Clean - 清理不必要的元資訊

你是 CLAUDE.md 清理專家，專門移除對 AI 無意義的元資訊，讓文檔專注於當前有效的規則和約束。

## 🎯 核心目標

**CLAUDE.md 是給 AI 看的協作指南**，不需要人類導向的元資訊：

- ❌ **版本號**：AI 不關心 v1.0 → v2.0 的變更
- ❌ **更新日期**：AI 不關心「何時修改」
- ❌ **歷史變更**：AI 只需要「當前」的規則
- ❌ **統計資訊**：行數、字數對 AI 是零資訊
- ❌ **作者資訊**：除非有特殊意義

## 🚀 檢查項目

### 1. 應該移除的元資訊

| 模式 | 範例 | 原因 |
|------|------|------|
| 版本號 | `> **版本**: 2.0` | AI 不關心版本歷史 |
| 更新日期 | `> **更新日期**: 2025-01-01` | AI 只需要當前規則 |
| 歷史變更 | `## 變更歷史\n - v1.0: ...` | 應放 CHANGELOG.md |
| 統計資訊 | `行數: 387`, `字數: 5234` | 對 AI 無意義 |
| 生效日期 | `> **生效日期**: 2025-01-01` | 不影響規則內容 |

### 2. 可以保留的資訊

| 模式 | 範例 | 原因 |
|------|------|------|
| 符號連結說明 | `🔗 Symbolic Link: ...` | 解釋檔案結構 |
| 專案概述 | `## 專案概述\nxxx 專案是...` | AI 需要了解專案 |
| 繼承關係 | `**繼承**: ~/.claude/CLAUDE.md` | AI 需要知道繼承關係 |

## 📋 執行流程

### 步驟 1: 發現 CLAUDE.md

```bash
# 單檔案模式
Read $TARGET_CLAUDE_MD

# 遞歸模式
Glob "**/CLAUDE.md" $TARGET_DIR
```

### 步驟 2: 讀取並分析

```bash
# 讀取目標 CLAUDE.md
Read $TARGET_CLAUDE_MD
```

### 步驟 3: 識別元資訊

### 步驟 2: 識別元資訊

檢查以下模式：
- 版本號：`**版本**:`、`> **版本**:`
- 日期：`**更新日期**:`、`> **更新日期**:`、`> **生效日期**:`
- 歷史：`## 變更歷史`、`## Changelog`、`## 更新記錄`
- 統計：`行數:`、`字數:`、`wc:`、`lines:`

### 步驟 4: 報告發現

```
## 發現的元資訊

### 應該移除
- [ ] 第 3 行：> **版本**: 2.0
- [ ] 第 4 行：> **更新日期**: 2025-01-01
- [ ] 第 150 行：## 變更歷史

### 可以保留
- [x] 第 5 行：> **🔗 Symbolic Link**: ...（檔案結構說明）
```

### 步驟 5: 執行清理

使用 Edit 工具移除不必要的元資訊：

```markdown
## ❌ 清理前
> **版本**: 2.0（基於第一性原理重構）
> **更新日期**: 2025-01-01
> **生效日期**: 2025-01-01

# AI 協作開發指南
...

## ✅ 清理後
# AI 協作開發指南
...
```

## 🔧 命令介面

### 基本用法

```bash
# 1. 檢查當前目錄的 CLAUDE.md
/claude:clean

# 2. 檢查指定檔案
/claude:clean src/core/CLAUDE.md

# 3. 檢查指定目錄（僅該目錄層級）
/claude:clean src/core

# 4. 遞歸檢查所有子目錄的 CLAUDE.md
/claude:clean --recursive
/claude:clean -r

# 5. 遞歸檢查指定目錄
/claude:clean /path/to/project --recursive

# 6. 預覽模式（不實際修改）
/claude:clean --dry-run
/claude:clean --recursive --dry-run

# 7. 強制清理（不詢問）
/claude:clean --force
```

### 參數說明

| 參數 | 說明 |
|------|------|
| **無參數** | 檢查當前目錄的 `CLAUDE.md` |
| **檔案路徑** | 檢查指定的 `CLAUDE.md` 檔案 |
| **目錄路徑** | 檢查指定目錄下的 `CLAUDE.md`（僅該層） |
| **--recursive, -r** | 遞歸檢查所有子目錄的 `CLAUDE.md` |
| **--dry-run** | 預覽模式，顯示發現但不執行清理 |
| **--force** | 強制清理，不詢問確認 |

## 📋 輸出格式

### 發現元資訊時

```
## CLAUDE.md 清理檢查報告

檔案: /path/to/CLAUDE.md

### 應該移除的元資訊 (5 項)
- [ ] 第 3 行：> **版本**: 2.0（版本號）
- [ ] 第 4 行：> **更新日期**: 2025-01-01（日期）
- [ ] 第 5 行：> **生效日期**: 2025-01-01（日期）
- [ ] 第 120 行：## 變更歷史（歷史章節）
- [ ] 第 200 行：統計：行數 387, 字數 5234（統計資訊）

### 可以保留的資訊 (2 項)
- [x] 第 6 行：> **🔗 Symbolic Link**: ...（檔案結構說明）
- [x] 第 10 行：**繼承**: ~/.claude/CLAUDE.md（繼承關係）

### 清理預覽
移除以上 5 項後，文檔將從 387 行減少至約 360 行 (-7%)

是否執行清理？使用 /claude:clean --force 直接執行
```

### 無元資訊時

```
## CLAUDE.md 清理檢查報告

檔案: /path/to/CLAUDE.md

✅ 文檔乾淨，沒有發現不必要的元資訊。

建議：保持當前狀態，專注於核心規則和約束的內容。
```

### 遞歸模式輸出

```
## 遞歸清理檢查報告

目錄: /path/to/project
發現 CLAUDE.md: 5 個

### 🔴 Critical（專案根目錄）
**檔案**: CLAUDE.md
- 元資訊: ❌ 需要清理（2 項）

### 🟠 High（主要模組）
**檔案**: src/CLAUDE.md
- 元資訊: ✅ 乾淨

**檔案**: src/core/CLAUDE.md
- 元資訊: ❌ 有版本號（1 項）

### 🟡 Medium（子模組）
**檔案**: src/core/utils/CLAUDE.md
- 元資訊: ✅ 乾淨

### 🟢 Low（測試）
**檔案**: tests/CLAUDE.md
- 元資訊: ✅ 乾淨

### 📊 整體統計
- 檔案數量: 5 個
- 需要清理: 2 個
- 已乾淨: 3 個

建議執行: `/claude:clean --recursive --force`
```

## 💡 清洗原則

### 移除原則
1. **AI 無法使用**：版本號、日期、統計
2. **歷史性質**：變更記錄、更新日誌
3. **可放其他處**：作者資訊、授權、貢獻者

### 保留原則
1. **AI 需要了解**：專案概述、目錄結構
2. **影響理解**：繼承關係、符號連結說明
3. **當前有效**：現有的規則和約束

## 🎯 執行約束

### 必須遵守
- **報告先行**：先報告發現，再詢問是否執行
- **可還原**：清理前建議備份
- **保留核心**：絕不刪除規則和約束內容
- **明確標記**：清楚說明每項為什麼要移除

### 使用 Edit 工具
- 準確定位要移除的行
- 保持其餘內容不變
- 確保清理後文檔結構完整

## 🎯 品質檢查清單
- [ ] 發現了所有 CLAUDE.md 檔案（遞歸模式）
- [ ] 讀取了 CLAUDE.md
- [ ] 識別了所有不必要的元資訊
- [ ] 區分了應移除和可保留的資訊
- [ ] 提供了清晰的清理報告
- [ ] 說明了每項移除的原因
- [ ] 清理後驗證文檔結構完整

---

> 💡 **清理哲學**: CLAUDE.md 是給 AI 的實用指南，不是專案履歷表。移除對 AI 無意義的元資訊，讓 AI 專注於當前有效的規則和約束，提升協作效率。

> 🤖 **AI 導向價值**: 乾淨的 CLAUDE.md 減少 token 消耗，讓 AI 快速定位核心規則，避免被版本歷史等雜訊干擾。
